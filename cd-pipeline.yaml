name: CD-Pipeline

trigger: none

resources:
  pipelines:
  - pipeline: dependant-cd-pipeline
    source: john-morsley.azure-pipelines-poc-ci
    project: azure-pipeline-poc
    branch: main
    trigger:
     branches:
      include:
      - main 

pool:
  vmImage: ubuntu-latest

variables:
  azureSubscription: 'morsley-uk-test'
  webAppName: 'morsley-uk-test-api'
  artifactName: 'drop'
  packagePath: 'Morsley.UK.Test.API.zip'

# Deploy our test API to production...  
- task: AzureWebApp@1
  displayName: '--> Deploy to Production <--'
  inputs: 
    azureSubscription: '$(azureSubsription)'
    webAppName: '$(webAppName)'
    appType: 'webApp'
    package: '$(Pipeline.Workspace)/ci/$(artifactName)/$(packagePath)'
